(()=>{"use strict";class t{static binToPaymentSystem={"card-american-express":[34,37],"card-china-t-union":[31],"card-unionpay":[62],"card-diners":[2014,2149,36,[300,305],3095,38,39],"card-discover":[6011,[644,649],65,[622126,622925]],"card-jcb":[[3528,3589]],"card-maestro":[6759,676770,676774,5018,5020,5038,5893,6304,[6761,6763]],"card-mir":[[2200,2204]],"card-mastercard":[[2221,2720],[51,55]],"card-visa":[4,4026,417500,4508,4844,4913,4917]};static searchPaymentSystem(i){let e,a=0;for(const s in t.binToPaymentSystem){const n=t.binToPaymentSystem[s];for(const t of n)if(Array.isArray(t)){const[n,r]=t,c=String(n).length,o=i.slice(0,c);o>=n&&o<=r&&c>a&&(a=c,e=s)}else{const n=String(t).length;i.startsWith(t)&&n>a&&(a=n,e=s)}}return e}}class i{static cardChecks(t){const i=t.split(""),e=+i[i.length-1];let a=!0,s=0;for(let t=i.length-2;t>=0;t--){if(a){let e=2*i[t];e>9&&(e-=9),s+=e}else s+=+i[t];a=!a}return(10-s%10)%10===e}}class e{constructor(t){this.container=this.bindToDOM(t),this.formValidator,this.inputValidator,this.submitValidator,this.cardsList,this.notice,this.timeout,this.init()}init(){this.createWidget(),this.eventInit()}bindToDOM(t){if(!(t instanceof HTMLElement))throw new Error("Container is not HTMLElement!");return t}eventInit(){this.formValidator.addEventListener("submit",this.onSubmit.bind(this)),this.inputValidator.addEventListener("input",this.onInput.bind(this))}onSubmit(t){t.preventDefault();const e=this.inputValidator.value.trim();e?i.cardChecks(e)?this.outputNotice("The card is valid!","notice-info"):this.outputNotice("The card is not valid!","notice-error"):this.outputNotice("Enter the card number in the field!","notice-error")}onInput(){this.clearNotice(),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>this.displayPaymentSystems()),300)}displayPaymentSystems(){for(const t of this.cardsList)t.classList.add("inactive");const i=this.inputValidator.value.trim(),e=t.searchPaymentSystem(i);e&&this.container.querySelector(`.${e}`).classList.remove("inactive")}outputNotice(t,i){this.notice.className="notice",this.notice.classList.add(i),this.notice.textContent=t}clearNotice(){this.notice.className="notice",this.notice.textContent=""}createWidget(){this.container.insertAdjacentHTML("beforeend",'\n      <div class="credit-card-validator">\n        <ul class="payment-systems">\n          <li class="card card-mir inactive"></li>        \n          <li class="card card-visa inactive"></li>\n          <li class="card card-mastercard inactive"></li>\n          <li class="card card-maestro inactive"></li>\n          <li class="card card-china-t-union inactive"></li>\n          <li class="card card-unionpay inactive"></li>\n          <li class="card card-american-express inactive"></li>\n          <li class="card card-diners inactive"></li>\n          <li class="card card-jcb inactive"></li>\n          <li class="card card-discover inactive"></li>\n        </ul>      \n        <form class="form-validator">\n          <input class="input-validator" type="text" placeholder="Credit card number">\n          <input class="submit-validator" type="submit" value="Click to Validate">        \n        </form>\n        <span class="notice"></span>\n      </div> \n    '),this.formValidator=this.container.querySelector(".form-validator"),this.inputValidator=this.container.querySelector(".input-validator"),this.submitValidator=this.container.querySelector(".submit-validator"),this.cardsList=this.container.querySelectorAll(".card"),this.notice=this.container.querySelector(".notice")}}document.addEventListener("DOMContentLoaded",(()=>{new e(document.querySelector(".container"))}))})();